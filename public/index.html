<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">

		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>
		<link type="text/css" rel="stylesheet" href="css/index.css"  />

		<script src="main.js"></script>
		<title>Data-Mining Project</title>
	</head>
	<body>

		<!-- <a id="test2" class="waves-effect btn buttons">Test</a> -->
		<h3>Structure de données</h3>
		<div class="rapport">
			<p>Pour faciliter l'accès aux données, les 2 fichiers `playlists` et `tracks` sont fusionnés dans une seule structure de données.
			Ceci est plus pratique pour accéder aux propriétés des musiques depuis la playlist.</p>
			La structure de données utilisée est du JSON sous la forme suivante:
			<pre class="codeSample">
	"fr": {
		"https://www.spotontrack.com/track/la-marcheuse/42943174": {
			"title": "La marcheuse",
			"artists": "Christine and the Queens",
			"BPM": 107,
			<span class="comment">…</span>
			"positions": [{
				"date": 2018-09-26T00:00:00.000Z, "position": 2
			}, {
				"date": 2018-10-03T00:00:00.000Z, "position": 3
			}, <span class="comment">…</span>]
		},
		"https://www.spotontrack.com/track/mojo/43473376": {
			<span class="comment">…</span>
		},
		<span class="comment">…</span>
	},
	"jazz": {
		<span class="comment">…</span>
	},
	"lovepop": {
		<span class="comment">…</span>
	},
	"electro": {
		<span class="comment">…</span>
	},
	"metal": {
		<span class="comment">…</span>
	}
		</pre>
		Cette structure nous permet de séparer les différentes playlists, ainsi l'appel à `data.fr` renvoie toutes les chansons de la playlist fr.
		


		<h4>Traitement des caractères accentués</h4>
		Une simple expression régulière règle ce problème. <pre>/\\u[0-9a-f]{4}/g</pre> détecte les codes des caractères accentués et il est en suite facile de les convertir.
		</div>
		


		<!-- 2.1 -->
		<h3>Préparation des données</h3>

		<!-- 2.1.1 -->
		<h4>Positions-pics</h4>
		<div class="fonctionAssociee">Fonction <span>getPositionPic</span></div>
		<div class="rapport">
			<!-- Des fonctions requéttant le serveur pour trouver proprement les rapport via les .txt sont prêts dans le .js mais json ne permet pas de bien mettre en forme-->
			<p>Afin de calculer la position-pic de chaque chanson, il nous suffit de parcourir la structure de données évoquées via des itérateurs natifs de JavaScript :</p>

			<p>- Pour chaque playlist</p>
			<p>&nbsp;- Pour chaque chanson de cette playlist</p>
			<p>&nbsp;&nbsp;- On initialise la meilleure position à l’entier maximal</p>
			<p>&nbsp;&nbsp;- Pour chaque position de cette chanson</p>
			<p>&nbsp;&nbsp;&nbsp;- On modifie la meilleure position si la position trouvée est meilleure que la meilleure position-pic</p>
			<p>- On retourne la structure adaptée</p>
		</div>
		<div class="code">
			<h6><img src="images/gears.png" alt="Engrenages" /><div>Code</div></h6>
			<p>En JavaScript, nous parcourons notre structure avec des for de cette manière :</p>
			<div class="codeSample">
					for(let [playlist, songs] of Object.entries(data)) { <br />
						&nbsp;&nbsp;<span class="comment">// Du code utilisant playlist et/ou songs</span> <br />
					} <br />
			</div>
			<p>Si data est, par exemple, de cette forme :</p>
			<div class="codeSample">
					"fr": {<br />
						&nbsp;&nbsp;"url1": {<br />
							&nbsp;&nbsp;&nbsp;&nbsp;	<span class="comment">…</span><br />
						&nbsp;&nbsp;}, "url2": {<br />
							&nbsp;&nbsp;&nbsp;&nbsp;	<span class="comment">…</span><br />
						&nbsp;&nbsp;},<br />
						&nbsp;&nbsp;<span class="comment">…</span><br />
					},<br />
					"electro": {<br />
						&nbsp;&nbsp;<span class="comment">…</span><br />
					},<br />
					<span class="comment">…</span><br />
			</div>
			<p>Nous aurons alors, pour le premier tour de boucle, playlist = « fr » et songs égal à la structure contenant url1, url2... (chaque url étant alors itérable de la même manière). Au deuxième tour nous aurons playlist = « electro »…</p>
			<p>Il est également possible de ne récupérer que playlist en utilisant key au lieu entries, et uniquement songs en utilisant plutôt values.</p>
		</div>
		<div class="question">
			<a id="question2_1_1" class="waves-effect btn buttons">Positions-pic</a>
		</div>
		<div id="resultQuestion2_1_1" class="center-align result"></div>

		<!-- 2.1.2 -->
		<h4>Positions-pic inférieures à 15</h4>
		<p>Mettre le rapport ici</p>
		<div class="question">
			<a id="question2_1_2" class="waves-effect btn buttons">Positions-pic inférieures à 15</a>
		</div>
		<div id="resultQuestion2_1_2" class="center-align result"></div>

		<!-- 2.1.3 -->
		<h4>Durée pendant laquelle la chanson est apparue dans la playlist</h4>
		<p>Mettre le rapport ici</p>
		<div class="question">
				<a id="question2_1_3" class="waves-effect btn buttons">Durée d'apparition</a>
		</div>
		<div id="resultQuestion2_1_3" class="center-align result"></div>
		
		<!-- 2.1.4 -->
		<h4>Position moyenne de la chanson dans la playlist</h4>
		<p>Mettre le rapport ici</p>
		<div class="question">
				<a id="question2_1_4" class="waves-effect btn buttons">Position moyenne</a>
		</div>
		<div id="resultQuestion2_1_4" class="center-align result"></div>

		<!-- 2.1.5 -->
		<h4>Position moyenne inférieures à 15</h4>
		<p>Mettre le rapport ici</p>
		<div class="question">
				<a id="question2_1_5" class="waves-effect btn buttons">Positions moyennes inférieures à 15</a>
		</div>
		<div id="resultQuestion2_1_5" class="center-align result"></div>


		<!-- 2.2 -->
		<h3>Analyse Exploratoire</h3>

		<!-- 2.2.1 -->
		<h4>Analyse descriptive 2D</h4>
		<p>Mettre le rapport ici</p>
		<div class="question">
			<a id="question2_2_1" class="waves-effect btn buttons">Analyse</a>
		</div>
		<div id="resultQuestion2_2_1" class="center-align result"></div>

		<!-- 2.2.2 -->
		<h4>Profil de la chanson moyenne pour chaque playlist</h4>
		<p>Mettre le rapport ici</p>
		<div class="question">
			<a id="question2_2_2" class="waves-effect btn buttons">Profil de la chanson moyenne</a>
		</div>
		<div id="resultQuestion2_2_2" class="center-align result"></div>

		<!-- 2.2.3 -->
		<h4>Chanson avec la meilleure position moyenne pour chaque playlist</h4>
		<p>Mettre le rapport ici</p>
		<div class="question">
			<a id="question2_2_3" class="waves-effect btn buttons">Meilleures positions moyennes</a>
		</div>
		<div id="resultQuestion2_2_3" class="center-align result"></div>

		<!-- 2.2.4 -->
		<h4>Evolution de la position d'une chanson au fil du temps</h4>
		<p>Mettre le rapport ici</p>
		<div class="question">
			<a id="question2_2_4" class="waves-effect btn buttons">Evolution de la position moyenne d'une chanson</a>
			<select id="question2_2_4_select">
				<optgroup label="fr">
					<option value="https://www.spotontrack.com/track/assassine-de-la-nuit/36729603">Assssine de la nuit (https://www.spotontrack.com/track/assassine-de-la-nuit/36729603)</option>
				</optgroup>
				<optgroup label="jazz">
					<option value="https://www.spotontrack.com/track/i-got-it-bad-and-that-ain-t-good/361744">I Got It Bad And That Anin't Good (https://www.spotontrack.com/track/i-got-it-bad-and-that-ain-t-good/361744)</option>
				</optgroup>
				<optgroup label="lovepop">
					<option value="https://www.spotontrack.com/track/wasn-t-expecting-that/2230">Wasn't Expecting That (https://www.spotontrack.com/track/wasn-t-expecting-that/2230)</option>
				</optgroup>
				<optgroup label="electro">
					<option value="https://www.spotontrack.com/track/ohm/40765440">Ohm (https://www.spotontrack.com/track/ohm/40765440)</option>
				</optgroup>
				<optgroup label="metal">
					<option value="https://www.spotontrack.com/track/twilight-of-the-thunder-god/1117533" selected>Twilight Of The Thunder God (https://www.spotontrack.com/track/twilight-of-the-thunder-god/1117533)</option>
				</optgroup>
			</select>
		</div>
		<div id="resultQuestion2_2_4" class="center-align chart"></div>


		<script type="text/javascript" src="js/materialize.min.js"></script>
		<script type="text/javascript" src="js/chart.min.js"></script>
	</body>
</html>